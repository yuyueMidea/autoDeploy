import{a as p,e as m,o as v,f as e,v as d,z as w,j as k,t as b,y as x}from"./vendor-BxZyEcZi.js";const A=async()=>await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),C=async l=>{const a=await crypto.subtle.exportKey("raw",l);return btoa(String.fromCharCode(...new Uint8Array(a)))},f=async l=>{const a=atob(l),n=new Uint8Array(a.length);for(let s=0;s<a.length;s++)n[s]=a.charCodeAt(s);return await crypto.subtle.importKey("raw",n,{name:"AES-GCM"},!0,["encrypt","decrypt"])},_=async(l,a)=>{const n=crypto.getRandomValues(new Uint8Array(12)),s=new TextEncoder().encode(JSON.stringify(a)),c=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},l,s),r=new Uint8Array(n.length+c.byteLength);return r.set(n,0),r.set(new Uint8Array(c),n.length),btoa(String.fromCharCode(...r))},U=async(l,a)=>{const n=atob(a),s=new Uint8Array(n.length);for(let i=0;i<n.length;i++)s[i]=n.charCodeAt(i);const c=s.slice(0,12),r=s.slice(12),u=await crypto.subtle.decrypt({name:"AES-GCM",iv:c},l,r);return JSON.parse(new TextDecoder().decode(u))},h={class:"p-5"},E={class:"border"},K={class:"p-5"},V={class:"p-5"},B={class:"p-5"},M={class:"p-5"},T={class:"p-5"},G={class:"m-5"},N={class:"m-5"},I={class:"m-5"},O={__name:"CryptoPage",setup(l){const a=p("Alice"),n=p("alice@example.com"),s=p("sensitive-auth-token"),c=p(null),r=p(null),u=p(null),i=async()=>{try{const o=await A();c.value=await C(o);const t={name:a.value,email:n.value,token:s.value};r.value=await _(o,t),localStorage.setItem("encryptedUserData",r.value)}catch(o){console.error("加密失败:",o)}},D=async()=>{try{const o=localStorage.getItem("encryptedUserData");if(o){const t=await f(c.value);u.value=await U(t,o)}}catch(o){console.error("解密失败:",o)}};return(o,t)=>{const g=x("track"),S=x("permission");return v(),m("div",h,[t[9]||(t[9]=e("h1",null,"前端对用户信息加密与解密",-1)),e("div",E,[e("p",K,[t[3]||(t[3]=e("span",{class:"inline w-100"},"username",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=y=>a.value=y),class:"border p-5 m-5"},null,512),[[w,a.value]])]),e("p",V,[t[4]||(t[4]=e("span",{class:"inline w-100"},"email",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=y=>n.value=y),class:"border p-5 m-5"},null,512),[[w,n.value]])]),e("p",B,[t[5]||(t[5]=e("span",{class:"inline w-100"},"token",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=y=>s.value=y),class:"border p-5 m-5"},null,512),[[w,s.value]])]),t[8]||(t[8]=e("p",{class:"p-5"}," 完整流程说明: 1. 生成密钥 → 2. 导出密钥为字符串 → 3. 存储密钥到安全位置 → 4. 加密用户数据 → 5. 解密时恢复密钥 ",-1)),e("p",M,[d((v(),m("button",{class:"btn",onClick:i},t[6]||(t[6]=[k("加密")]))),[[g,"setcryptoBtn",void 0,{click:!0}],[S,"admin"]]),d((v(),m("button",{class:"btn",onClick:D},t[7]||(t[7]=[k("解密")]))),[[g,"getcryptoBtn",void 0,{click:!0}],[S,"admin"]])]),e("div",T,[e("p",G,"Base64 格式的密钥字符串: "+b(c.value),1),e("p",N,"加密结果: "+b(r.value),1),e("p",I,"解密结果: "+b(u.value),1)])])])}}};export{O as default};
