import{_ as d}from"./index-DtvQI-2Q.js";import{p as i,C as m,G as v,a as u,o as _,b as o,t as l,F as k,f}from"./vendor-D_AaPtq8.js";const b={class:"div_wrapper"},g={class:"device-list"},h={class:"device-actions"},y=["onClick"],C=["onClick"],S=["onClick"],w={__name:"WebSocketPage",setup(W){const n=i({}),c=i("disconnected"),a=i(null);m(()=>{const t=new WebSocket("ws://127.0.0.1:8080");t.onopen=()=>{c.value="connected",console.log("WebSocket连接已建立")},t.onerror=s=>{c.value="error",console.error("WebSocket错误:",s)},t.onmessage=s=>{const e=JSON.parse(s.data);e.type==="init"?(console.log("initttt: ",e.data),n.value=e.data):e.type==="update"?n.value=e.data:e.type==="command_response"&&console.log("command_response_: ",e)},a.value=t});const r=(t,s)=>{a.value&&a.value.send(JSON.stringify({type:"command",deviceId:t,command:s}))};return v(()=>{a.value&&(console.log("leave,close ws!"),a.value.close())}),(t,s)=>(_(),u("div",b,[o("h2",null,"物联网设备状态 (状态: "+l(c.value)+")",1),o("div",g,[(_(!0),u(k,null,f(Object.keys(n.value),e=>(_(),u("div",{key:e,class:"device-card"},[o("h3",null,"设备ID: "+l(e),1),o("p",null,"温度: "+l(n.value[e].temperature)+"°C",1),o("p",null,"湿度: "+l(n.value[e].humidity)+"%",1),o("p",null,"状态: "+l(n.value[e].status),1),o("div",h,[o("button",{onClick:p=>r(e,"online")},"上线",8,y),o("button",{onClick:p=>r(e,"offline")},"下线",8,C),o("button",{onClick:p=>r(e,"restart")},"重启",8,S)])]))),128))])]))}},D=d(w,[["__scopeId","data-v-c3a781e5"]]);export{D as default};
